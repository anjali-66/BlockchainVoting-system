{"ast":null,"code":"import { NATIVE_TOKEN_ADDRESS } from \"../../constants/addresses.js\";\nimport { getBytecode } from \"../../contract/actions/get-bytecode.js\";\nimport { getContract } from \"../../contract/contract.js\";\nimport { isAddress } from \"../../utils/address.js\";\nimport { getClientFetch } from \"../../utils/fetch.js\";\nimport { getPayConvertFiatToCryptoEndpoint } from \"../utils/definitions.js\";\n/**\n * Convert a fiat value to a token.\n * Currently only USD is supported.\n * @example\n * ### Basic usage\n * ```ts\n * import { convertFiatToCrypto } from \"thirdweb/pay\";\n *\n * // Convert 2 cents to ETH\n * const result = await convertFiatToCrypto({\n *   from: \"USD\",\n *   // the token address. For native token, use NATIVE_TOKEN_ADDRESS\n *   to: \"0x...\",\n *   // the chain (of the chain where the token belong to)\n *   chain: ethereum,\n *   // 2 cents\n *   fromAmount: 0.02,\n * });\n * ```\n * Result: `{ result: 0.0000057 }`\n * @buyCrypto\n */\nexport async function convertFiatToCrypto(options) {\n  const {\n    client,\n    from,\n    to,\n    chain,\n    fromAmount\n  } = options;\n  if (Number(fromAmount) === 0) {\n    return {\n      result: 0\n    };\n  }\n  // Testnets just don't work with our current provider(s)\n  if (chain.testnet === true) {\n    throw new Error(`Cannot fetch price for a testnet (chainId: ${chain.id})`);\n  }\n  // Some provider that we are using will return `0` for unsupported token\n  // so we should do some basic input validations before sending the request\n  // Make sure it's a valid EVM address\n  if (!isAddress(to)) {\n    throw new Error(\"Invalid `to`. Expected a valid EVM contract address\");\n  }\n  // Make sure it's either a valid contract or a native token\n  if (to.toLowerCase() !== NATIVE_TOKEN_ADDRESS.toLowerCase()) {\n    const bytecode = await getBytecode(getContract({\n      address: to,\n      chain,\n      client\n    })).catch(() => undefined);\n    if (!bytecode || bytecode === \"0x\") {\n      throw new Error(`Error: ${to} on chainId: ${chain.id} is not a valid contract address.`);\n    }\n  }\n  const params = {\n    from,\n    to,\n    chainId: String(chain.id),\n    fromAmount: String(fromAmount)\n  };\n  const queryString = new URLSearchParams(params).toString();\n  const url = `${getPayConvertFiatToCryptoEndpoint()}?${queryString}`;\n  const response = await getClientFetch(client)(url);\n  if (!response.ok) {\n    throw new Error(`Failed to convert ${from} value to token (${to}) on chainId: ${chain.id}`);\n  }\n  const data = await response.json();\n  return data;\n}\n//# sourceMappingURL=fiatToCrypto.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}